<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_72) on Wed Jun 03 02:25:47 PDT 2015 -->
<title>SignatureMessageRecovery (Java Card API, Classic Edition)</title>
<meta name="date" content="2015-06-03">
<link rel="stylesheet" type="text/css" href="../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="SignatureMessageRecovery (Java Card API, Classic Edition)";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../index-all.html">Index</a></li>
<li><a href="../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../javacard/security/Signature.OneShot.html" title="class in javacard.security"><span class="strong">Prev Class</span></a></li>
<li>Next Class</li>
</ul>
<ul class="navList">
<li><a href="../../index.html?javacard/security/SignatureMessageRecovery.html" target="_top">Frames</a></li>
<li><a href="SignatureMessageRecovery.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">javacard.security</div>
<h2 title="Interface SignatureMessageRecovery" class="title">Interface SignatureMessageRecovery</h2>
</div>
<div class="contentContainer">
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public interface <span class="strong">SignatureMessageRecovery</span></pre>
<div class="block">A subclass of the abstract <code>Signature</code> class must implement this
 <code>SignatureMessageRecovery</code> interface to provide message recovery
 functionality. An instance implementing this interface is returned by the
 <a href="../../javacard/security/Signature.html#getInstance(byte,%20boolean)"><code>Signature.getInstance(byte, boolean)</code></a>
 method when algorithm type with suffix <code>*_MR</code> is specified. e.g.<a href="../../javacard/security/Signature.html#ALG_RSA_SHA_ISO9796_MR"><code>Signature.ALG_RSA_SHA_ISO9796_MR</code></a>.
 <p>
 This interface provides specialized versions of some of the methods defined
 in the <code>Signature</code> class to provide message recovery functions.
 An alternate version of the <code>sign()</code> and <code>verify()</code>
 methods is supported here along with a new <code>beginVerify</code> method
 to allow the message encoded in the signature to be recovered.
 <p>
 For signing a message with message recovery functionality, the user must cast
 the <code>Signature</code> object to this interface, initialize the object
 for signing with a private key using the <CODE>init()</CODE> method, and
 issue 0 or more <CODE>update()</CODE> method calls and then finally call
 the <CODE>sign()</CODE> method to obtain the signature.
 <p>
 For recovering the encoded message and verifying functionality, the user must
 cast the <code>Signature</code> object to this interface, initialize the
 object for verifying with a public key using the <CODE>init()</CODE>
 method, first recover the message using the <CODE>beginVerify()</CODE>
 method and then issue 0 or more <CODE>update()</CODE> method calls and then
 finally call the <CODE>verify()</CODE> method to verify the signature.
 <p>
 Note:<br>
 A <CODE>Signature</CODE> object implementing this interface must throw
 <CODE>CryptoException</CODE> with <CODE>CryptoException.ILLEGAL_USE</CODE>
 reason code when one of the following methods applicable only to a
 <CODE>Signature</CODE> object which does not include message recovery
 functionality, is called:
 <ul>
 <li><em>init(Key, byte, byte[], short, short)</em>
 <li><em>sign(byte[], short, short, byte[], short)</em>
 <li><em>verify(byte[], short, short, byte[], short, short)</em>
 <li><em>setInitialDigest(byte[], short, short, byte[], short, short)</em>
 <li><em>signPreComputedHash(byte[], short, short, byte[], short)</em>
 </ul></div>
<dl><dt><span class="strong">Since:</span></dt>
  <dd>2.2.2</dd></dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>short</code></td>
<td class="colLast"><code><strong><a href="../../javacard/security/SignatureMessageRecovery.html#beginVerify(byte[],%20short,%20short)">beginVerify</a></strong>(byte[]&nbsp;sigAndRecDataBuff,
           short&nbsp;buffOffset,
           short&nbsp;sigLength)</code>
<div class="block">This method begins the verification sequence by recovering the message
 encoded within the signature itself and initializing the internal hash
 function.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>byte</code></td>
<td class="colLast"><code><strong><a href="../../javacard/security/SignatureMessageRecovery.html#getAlgorithm()">getAlgorithm</a></strong>()</code>
<div class="block">Gets the Signature algorithm.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>short</code></td>
<td class="colLast"><code><strong><a href="../../javacard/security/SignatureMessageRecovery.html#getLength()">getLength</a></strong>()</code>
<div class="block">Returns the byte length of the signature data.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../javacard/security/SignatureMessageRecovery.html#init(javacard.security.Key,%20byte)">init</a></strong>(<a href="../../javacard/security/Key.html" title="interface in javacard.security">Key</a>&nbsp;theKey,
    byte&nbsp;theMode)</code>
<div class="block">Initializes the <code>Signature</code> object with the appropriate
 <code>Key</code>.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>short</code></td>
<td class="colLast"><code><strong><a href="../../javacard/security/SignatureMessageRecovery.html#sign(byte[],%20short,%20short,%20byte[],%20short,%20short[],%20short)">sign</a></strong>(byte[]&nbsp;inBuff,
    short&nbsp;inOffset,
    short&nbsp;inLength,
    byte[]&nbsp;sigBuff,
    short&nbsp;sigOffset,
    short[]&nbsp;recMsgLen,
    short&nbsp;recMsgLenOffset)</code>
<div class="block">Generates the signature of all/last input data.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../javacard/security/SignatureMessageRecovery.html#update(byte[],%20short,%20short)">update</a></strong>(byte[]&nbsp;inBuff,
      short&nbsp;inOffset,
      short&nbsp;inLength)</code>
<div class="block">Accumulates a signature of the input data.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../javacard/security/SignatureMessageRecovery.html#verify(byte[],%20short,%20short)">verify</a></strong>(byte[]&nbsp;inBuff,
      short&nbsp;inOffset,
      short&nbsp;inLength)</code>
<div class="block">Verifies the signature of all/last input data against the passed in
 signature.</div>
</td>
</tr>
</table>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="init(javacard.security.Key, byte)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>init</h4>
<pre>void&nbsp;init(<a href="../../javacard/security/Key.html" title="interface in javacard.security">Key</a>&nbsp;theKey,
        byte&nbsp;theMode)
          throws <a href="../../javacard/security/CryptoException.html" title="class in javacard.security">CryptoException</a></pre>
<div class="block">Initializes the <code>Signature</code> object with the appropriate
 <code>Key</code>. This method should be used for algorithms which do
 not need initialization parameters or use default parameter values.
 <p>
 <code>init()</code> must be used to update the <code>Signature</code>
 object with a new key. If the <code>Key</code> object is modified after
 invoking the <code>init()</code> method, the behavior of the
 <code>update()</code>, <code>sign()</code>, and
 <code>verify()</code> methods is unspecified.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>theKey</code> - the key object to use for signing or verifying</dd><dd><code>theMode</code> - one of <code>MODE_SIGN</code> or <code>MODE_VERIFY</code></dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../javacard/security/CryptoException.html" title="class in javacard.security">CryptoException</a></code> - with the following reason codes:
                <ul>
                <li><code>CryptoException.ILLEGAL_VALUE</code> if
                <code>theMode</code> option is an undefined value or if
                the <code>Key</code> is inconsistent with
                <code>theMode</code> or with the <code>Signature</code>
                implementation.
                <li><code>CryptoException.UNINITIALIZED_KEY</code> if
                <code>theKey</code> instance is uninitialized.
                </ul></dd></dl>
</li>
</ul>
<a name="beginVerify(byte[], short, short)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>beginVerify</h4>
<pre>short&nbsp;beginVerify(byte[]&nbsp;sigAndRecDataBuff,
                short&nbsp;buffOffset,
                short&nbsp;sigLength)
                  throws <a href="../../javacard/security/CryptoException.html" title="class in javacard.security">CryptoException</a></pre>
<div class="block">This method begins the verification sequence by recovering the message
 encoded within the signature itself and initializing the internal hash
 function. The recovered message data overwrites the signature data in the
 <code>sigAndRecDataBuff</code> input byte array.
 <p>
 Notes:
 <ul>
 <li><em>This method must be called during the verification sequence
  prior to either the </em><code>update()</code><em> or the </em><code>verify()</code><em> methods during verification.</em>
 <li><em> The trailing (</em><code>sigLength</code><em> - recovered message length) bytes of 
 signature data in </em><code>sigAndRecDataBuff</code><em> may also be overwritten
 by this method.</em>
 </ul></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>sigAndRecDataBuff</code> - contains the signature data as input and also contains the
            recoverable part of the message as output.</dd><dd><code>buffOffset</code> - offset into the sigAndRecDataBuff array where data begins for
            signature and where this method will start writing recovered
            message data.</dd><dd><code>sigLength</code> - the length of signature data</dd>
<dt><span class="strong">Returns:</span></dt><dd>byte length of recovered message data written to
         <code>sigAndRecDataBuff</code></dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../javacard/security/CryptoException.html" title="class in javacard.security">CryptoException</a></code> - with the following reason codes:
                <ul>
                <li><code>CryptoException.ILLEGAL_USE</code> for the
                following conditions:
                <ul>
                <li>if this object is initialized for signature sign mode
                <li>if <code>sigLength</code> is inconsistent with this
                <code>Signature</code> algorithm
                <li>if the decrypted message representative does not meet
                the algorithm specifications
                <li>if the bit length of the decrypted message
                representative is not a multiple of 8.
                </ul>
                <li><code>CryptoException.UNINITIALIZED_KEY</code> if
                key not initialized.
                <li><code>CryptoException.INVALID_INIT</code> if this
                <code>Signature</code> object is not initialized.
                </ul></dd></dl>
</li>
</ul>
<a name="sign(byte[], short, short, byte[], short, short[], short)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>sign</h4>
<pre>short&nbsp;sign(byte[]&nbsp;inBuff,
         short&nbsp;inOffset,
         short&nbsp;inLength,
         byte[]&nbsp;sigBuff,
         short&nbsp;sigOffset,
         short[]&nbsp;recMsgLen,
         short&nbsp;recMsgLenOffset)
           throws <a href="../../javacard/security/CryptoException.html" title="class in javacard.security">CryptoException</a></pre>
<div class="block">Generates the signature of all/last input data. In addition, this method
 returns the number of bytes beginning with the first byte of the message
 that was encoded into the signature itself. The encoded message is called
 the recoverable message and its length is called the recoverable message
 length. This recoverable message need not be transmitted and can be
 recovered during verification.
 <p>
 A call to this method also resets this <code>Signature</code> object to
 the state it was in when previously initialized via a call to
 <code>init()</code>. That is, the object is reset and available to
 sign another message.
 <p>
 The input and output buffer data may overlap.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>inBuff</code> - the input buffer of data to be signed</dd><dd><code>inOffset</code> - the offset into the input buffer at which to begin signature
            generation</dd><dd><code>inLength</code> - the byte length to sign</dd><dd><code>sigBuff</code> - the output buffer to store signature data</dd><dd><code>sigOffset</code> - the offset into sigBuff at which to begin signature data</dd><dd><code>recMsgLen</code> - the output buffer containing the number of bytes of the
            recoverable message beginning with the first byte of the
            message that was encoded into the signature itself</dd><dd><code>recMsgLenOffset</code> - offset into the <code>recMsgLen</code> output buffer where
            the byte length of the recoverable message is stored. Note
            that a single short value is stored at
            <code>recMsgLenOffset</code> offset.</dd>
<dt><span class="strong">Returns:</span></dt><dd>number of bytes of signature output in sigBuff</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../javacard/security/CryptoException.html" title="class in javacard.security">CryptoException</a></code> - with the following reason codes:
                <ul>
                <li><code>CryptoException.UNINITIALIZED_KEY</code> if
                key not initialized.
                <li><code>CryptoException.INVALID_INIT</code> if this
                <code>Signature</code> object is not initialized or
                initialized for signature verify mode.
                </ul></dd></dl>
</li>
</ul>
<a name="verify(byte[], short, short)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>verify</h4>
<pre>boolean&nbsp;verify(byte[]&nbsp;inBuff,
             short&nbsp;inOffset,
             short&nbsp;inLength)
               throws <a href="../../javacard/security/CryptoException.html" title="class in javacard.security">CryptoException</a></pre>
<div class="block">Verifies the signature of all/last input data against the passed in
 signature.
 <p>
 A call to this method also resets this <code>Signature</code> object to
 the state it was in when previously initialized via a call to
 <code>init()</code>. That is, the object is reset and available to
 verify another message.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>inBuff</code> - the input buffer of data to be verified</dd><dd><code>inOffset</code> - the offset into the input buffer at which to begin signature
            generation</dd><dd><code>inLength</code> - the byte length to sign</dd>
<dt><span class="strong">Returns:</span></dt><dd><code>true</code> if the signature verifies, <code>false</code>
         otherwise</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../javacard/security/CryptoException.html" title="class in javacard.security">CryptoException</a></code> - with the following reason codes:
                <ul>
                <li><code>CryptoException.UNINITIALIZED_KEY</code> if
                key not initialized.
                <li><code>CryptoException.INVALID_INIT</code> if this
                <code>Signature</code> object is not initialized or
                initialized for signature sign mode.
                <li><code>CryptoException.ILLEGAL_USE</code> if one of
                the following conditions is met:
                <ul>
                <li> if <code>beginVerify</code> method has not been
                called.
                </ul></dd></dl>
</li>
</ul>
<a name="getAlgorithm()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getAlgorithm</h4>
<pre>byte&nbsp;getAlgorithm()</pre>
<div class="block">Gets the Signature algorithm.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>the algorithm code implemented by this <code>Signature</code>
         instance.</dd></dl>
</li>
</ul>
<a name="getLength()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getLength</h4>
<pre>short&nbsp;getLength()
                throws <a href="../../javacard/security/CryptoException.html" title="class in javacard.security">CryptoException</a></pre>
<div class="block">Returns the byte length of the signature data.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>the byte length of the signature data</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../javacard/security/CryptoException.html" title="class in javacard.security">CryptoException</a></code> - with the following reason codes:
                <ul>
                <li><code>CryptoException.INVALID_INIT</code> if this
                <code>Signature</code> object is not initialized.
                <li><code>CryptoException.UNINITIALIZED_KEY</code> if
                key not initialized.
                </ul></dd></dl>
</li>
</ul>
<a name="update(byte[], short, short)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>update</h4>
<pre>void&nbsp;update(byte[]&nbsp;inBuff,
          short&nbsp;inOffset,
          short&nbsp;inLength)
            throws <a href="../../javacard/security/CryptoException.html" title="class in javacard.security">CryptoException</a></pre>
<div class="block">Accumulates a signature of the input data. This method requires temporary
 storage of intermediate results. In addition, if the input data length is
 not block aligned (multiple of block size) then additional internal
 storage may be allocated at this time to store a partial input data
 block. This may result in additional resource consumption and/or slow
 performance. This method should only be used if all the input data
 required for signing/verifying is not available in one byte array. If all
 of the input data required for signing/verifying is located in a single
 byte array, use of the <code>sign()</code> or <code>beginVerify</code>
 method and <code>verify()</code> method is recommended. The
 <code>sign()</code> or <code>verify()</code> method must be called to
 complete processing of input data accumulated by one or more calls to the
 <code>update()</code> method.
 <p>
 Note:
 <ul>
 <li><em>If <code>inLength</code> is 0 this method does nothing.</em>
 </ul></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>inBuff</code> - the input buffer of data to be signed/verified</dd><dd><code>inOffset</code> - the offset into the input buffer where input data begins</dd><dd><code>inLength</code> - the byte length to sign/verify</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../javacard/security/CryptoException.html" title="class in javacard.security">CryptoException</a></code> - with the following reason codes:
                <ul>
                <li><code>CryptoException.UNINITIALIZED_KEY</code> if
                key not initialized.
                <li><code>CryptoException.INVALID_INIT</code> if this
                <code>Signature</code> object is not initialized.
                <li><code>CryptoException.ILLEGAL_USE</code> if the
                mode set in the <code>init()</code> method is
                MODE_VERIFY and the <code>beginVerify()</code> method is
                not yet called.
                </ul></dd><dt><span class="strong">See Also:</span></dt><dd><a href="../../javacard/security/SignatureMessageRecovery.html#sign(byte[],%20short,%20short,%20byte[],%20short,%20short[],%20short)"><code>sign(byte[], short, short, byte[], short, short[], short)</code></a>, 
<a href="../../javacard/security/SignatureMessageRecovery.html#verify(byte[],%20short,%20short)"><code>verify(byte[], short, short)</code></a></dd></dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../index-all.html">Index</a></li>
<li><a href="../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../javacard/security/Signature.OneShot.html" title="class in javacard.security"><span class="strong">Prev Class</span></a></li>
<li>Next Class</li>
</ul>
<ul class="navList">
<li><a href="../../index.html?javacard/security/SignatureMessageRecovery.html" target="_top">Frames</a></li>
<li><a href="SignatureMessageRecovery.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small><a href="../../COPYRIGHT_jcspecs.html">Copyright</a> &copy; 1998, 2015, Oracle and/or its affiliates. All rights reserved.</small></p>
</body>
</html>
