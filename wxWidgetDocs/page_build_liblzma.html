<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>wxWidgets: Using LZMA compression with liblzma</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="extra_stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="page_container">
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0" style="width: 100%;">
 <tbody>
 <tr>
  <td id="projectlogo">
    <a href="https://www.wxwidgets.org/" target="_new">
      <img alt="wxWidgets" src="logo.png"/>
    </a>
  </td>
  <td style="padding-left: 0.5em; text-align: right;">
   <span id="projectnumber">Version: 3.1.4</span>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Using LZMA compression with liblzma </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>To use <a class="el" href="classwx_l_z_m_a_input_stream.html" title="This filter stream decompresses data in XZ format. ">wxLZMAInputStream</a> and <a class="el" href="classwx_l_z_m_a_output_stream.html" title="This filter stream compresses data using XZ format. ">wxLZMAOutputStream</a> classes, a public domain liblzma library is required when building wxWidgets.</p>
<p>This guide explains how to make liblzma available and let wxWidgets build system use it. The exact steps depend on the operating system and compiler used, please refer to the section appropriate for your environment below.</p>
<h1><a class="anchor" id="page_build_liblzma_unix"></a>
Unix-like operating system (including Cygwin)</h1>
<p>Under many Unix or Unix-like (including Cygwin) systems, liblzma is available as a system package and the simplest thing to do is to just install it using the system-specific tool (apt, yum, ...). Just note that you need to install the liblzma-dev or liblzma-devel package in order to obtain the library headers and not just the library itself.</p>
<p>If your system doesn't provide such package or you need to use a newer version than is available in the system repositories, it is also simple to build liblzma from sources: basically, just download the library sources from <a href="https://tukaani.org/xz/">https://tukaani.org/xz/</a> or clone its repository and perform the usual</p>
<div class="fragment"><div class="line">$ ./configure</div><div class="line">$ make</div><div class="line">$ make install</div></div><!-- fragment --><p>commands sequence.</p>
<p>As wxWidgets is built using either configure or CMake under Unix-like systems, there is nothing special to do to let wxWidgets use liblzma, as it will be detected automatically &ndash; just check the end of configure or CMake output to confirm that it was found. If this is not the case because the library was installed in some non-default location, you need to provide <code>CPPFLAGS</code> and <code>LDFLAGS</code> on configure command line, e.g.:</p>
<div class="fragment"><div class="line">$ ../configure CPPFLAGS=-I/opt/liblzma/include LDFLAGS=-L/opt/liblzma/lib</div></div><!-- fragment --><h1><a class="anchor" id="page_build_liblzma_msw"></a>
MSW not using configure</h1>
<p>When not using configure, you must edit <code>wx/msw/setup.h</code> file and change the value of <code>wxUSE_LIBLZMA</code> option to <code>1</code> manually in order to enable LZMA support, which is disabled by default.</p>
<p>Next, you need to actually ensure that the library is available to be able to build wxWidgets:</p>
<h2><a class="anchor" id="page_build_liblzma_msw_vcpkg"></a>
MSW using MSVS 2015 with Vcpkg</h2>
<p>If you build wxWidgets with Microsoft Visual Studio 2015.3 or later, you can use Microsoft vcpkg tool (see <a href="https://github.com/Microsoft/vcpkg">https://github.com/Microsoft/vcpkg</a>) to install liblzma as any other library and integrate it with Microsoft Visual Studio automatically. Please see vcpkg documentation for details, but, basically, it's as simple as executing the following commands:</p>
<div class="fragment"><div class="line">&gt; git clone https:<span class="comment">//github.com/Microsoft/vcpkg.git</span></div><div class="line">&gt; cd vcpkg</div><div class="line">&gt; .\bootstrap-vcpkg.bat</div><div class="line">&gt; .\vcpkg integrate install</div><div class="line">&gt; .\vcpkg install liblzma</div></div><!-- fragment --><p>Afterwards, liblzma headers and libraries (in DLL form) will be available to all C++ Visual Studio projects, including wxWidgets, so you just need to build it as usual, i.e. by opening <code>build/msw/wx_vcXX.sln</code> file and building it.</p>
<h1><a class="anchor" id="page_build_liblzma_msw_manual"></a>
MSW manual setup</h1>
<p>First of all, you need to either build or download liblzma binaries. Building the library from source with gcc requires configure, and as you don't use an environment capable of running it (if you're, you're reading the wrong section of this guide, please go to the first one instead), it might be simpler to just download the binaries from <a href="https://tukaani.org/xz/">https://tukaani.org/xz/</a></p>
<p>However these binaries don't provide import libraries for MSVC, so you may prefer building from source when using this compiler, provided it is at least 2013.2 or later (otherwise, you must use the binaries and create the import library from the DLL). To do it, simply open the MSVS solution provided under <code>windows</code> directory of the source archive corresponding to your compiler version and build all the relevant configurations. Notice that you may build it as either a static or a dynamic library, but if you choose the former, you must also predefine <code>LZMA_API_STATIC</code> when building wxWidgets.</p>
<p>Second, you need to let wxWidgets build system know about the liblzma headers and libraries location. When using makefiles, with either gcc or MSVC compiler, this can be done simply by specifying <code>CPPFLAGS</code> and <code>LDFLAGS</code> on make command line, e.g.</p>
<div class="fragment"><div class="line">&gt; make -f makefile.gcc CPPFLAGS=-Ic:/dev/include LDFLAGS=-Lc:/dev/lib</div></div><!-- fragment --><p>If you built liblzma as a static library, change <code>CPPFLAGS</code> to also include <code>-DLZMA_API_STATIC</code>.</p>
<p>When building wxWidgets with MSVC project files, you must update them to use liblzma. For this, start by copying build\msw\wx_setup.props file to build\msw\wx_local.props, if you don't have the latter file yet. Then open this file in your favourite editor and locate the <code>Link</code> tag inside an <code>ItemDefinitionGroup</code> tag and add a new <code>AdditionalIncludeDirectories</code> line inside the <code>ClCompile</code> tag as well as add <code>liblzma.lib</code> to the <code>AdditionalDependencies</code> tag under <code>Link</code> itself. The result should look like the following, assuming liblzma sources are in c:\src\liblzma:</p>
<div class="fragment"><div class="line">&lt;ItemDefinitionGroup&gt;</div><div class="line">  &lt;ClCompile&gt;</div><div class="line">    ... any existing lines here ...</div><div class="line">    &lt;AdditionalIncludeDirectories&gt;c:\src\liblzma\src\liblzma\api;%(AdditionalIncludeDirectories)&lt;/AdditionalIncludeDirectories&gt;</div><div class="line">    &lt;!--</div><div class="line">      Uncomment <span class="keyword">this</span> line <span class="keywordflow">if</span>, and only <span class="keywordflow">if</span>, you link with liblzma statically.</div><div class="line">    &lt;PreprocessorDefinitions&gt;LZMA_API_STATIC;%(PreprocessorDefinitions)&lt;/PreprocessorDefinitions&gt;</div><div class="line">      --&gt;</div><div class="line">  &lt;/ClCompile&gt;</div><div class="line">  &lt;Link&gt;</div><div class="line">    &lt;AdditionalDependencies&gt;... all the previously listed libraries;c:\src\liblzma\windows\vs2017\$(Configuration)\$(Platform)\liblzma_dll\liblzma.lib;%(AdditionalDependencies)&lt;/AdditionalDependencies&gt;</div><div class="line">  &lt;/Link&gt;</div><div class="line">&lt;/ItemDefinitionGroup&gt;</div></div><!-- fragment --><p>Afterwards, build wxWidgets as usual and don't forget to provide <code>liblzma.dll</code> when distributing your application unless you have decided to link it statically. </p>
</div></div><!-- contents -->

<address class="footer">
	<small>
		Generated on Wed Jul 22 2020 19:22:38 for wxWidgets by <a href="http://www.doxygen.org/index.html" target="_new">Doxygen</a> 1.8.13
	</small>
</address>
<script src="wxwidgets.js" type="text/javascript"></script>
</div><!-- #page_container -->
</body>
</html>